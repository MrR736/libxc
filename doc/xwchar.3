.\" XWCHAR(3) Manual Page
.TH XWCHAR 3 "2025" "Extern Library" "Programmer's Manual"
.SH NAME
xwcslen, vxwcslen, xwcscmp \- compute the length of a formatted wide string or compare wide strings
.SH SYNOPSIS
.nf
#include <xwchar.h>

size_t vxwcslen(const wchar_t *restrict fmt, va_list ap);
size_t xwcslen(const wchar_t *restrict fmt, ...);

int xwcscmp(const wchar_t * __s1, const wchar_t ** __s2, size_t n);
.fi
.SH DESCRIPTION
The xwchar library provides portable routines for wide-character string manipulation.

These functions allow:

.IP "\\fIxwcslen(), vxwcslen()\\fP"
Computing the number of wide characters required to format a string without producing output or allocating memory.

.IP "\\fIxwcscmp()\\fP"
Comparing a single wide string against an array of wide strings, returning a boolean-style result.
It is null-safe: a match occurs if both the target and array element are NULL, otherwise NULL elements are skipped.

.SH vxwcslen()
Computes the number of wide characters required to format the string described by \fIfmt\fP with arguments in \fIap\fP.

On Windows, wraps:

.RS
_vscwprintf(fmt, ap)
.RE

On POSIX systems, attempts:

.RS
vswprintf(NULL, 0, fmt, ap)
.RE

If unsupported or failing, an internal buffer is allocated and doubled until formatting succeeds or limits are reached.
The return value does not include the terminating NUL character.

.SH xwcslen()
A variadic wrapper around vxwcslen():

.nf
va_list ap;
va_start(ap, fmt);
len = vxwcslen(fmt, ap);
va_end(ap);
.fi

.SH xwcscmp()
Compares a wide string \fI__s1\fP against an array of wide strings \fI__s2\fP containing \fIn\fP elements.
Returns 1 if a match is found, 0 otherwise.

Null-safety behavior:

.IP
- Both \fI__s1\fP and an array element are NULL → match
.IP
- One is NULL → skipped
.IP
- Otherwise, compared using \fIwcscmp()\fP

.SH RETURN VALUES
vxwcslen(), xwcslen() return the number of wide characters required, excluding the terminating NUL.
On error, return 0; vxwcslen() sets errno to:

.TP
ENOMEM
Memory allocation failed during probing.
.TP
EOVERFLOW
Required buffer size exceeds internal limits.

xwcscmp() returns 1 if a match is found, 0 otherwise.

.SH ERRORS
vxwcslen() may set errno as described above. Windows does not set errno on failure.

.SH PORTABILITY
These functions are portable across Windows, Linux, BSD, and other POSIX systems.
Fallback probing ensures compatibility with libc implementations that do not support vswprintf(NULL,0,...).

.SH EXAMPLES
.nf
size_t len = xwcslen(L"%ls %d", L"hello", 42);
wchar_t *buf = malloc((len + 1) * sizeof(wchar_t));
swprintf(buf, len + 1, L"%ls %d", L"hello", 42);

const wchar_t *arr[] = {L"foo", L"bar", NULL};
int result = xwcscmp(L"bar", arr, 3); // returns 1
.fi

.SH SEE ALSO
swprintf(3), vswprintf(3), wcslen(3), wcscmp(3)

.SH AUTHOR
Written by MrR736.

.SH COPYRIGHT
GPLv3 or later.
