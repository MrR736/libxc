.\" XSTRING(3) Manual Page
.TH XSTRING 3 "2025" "Extern Library" "Programmer's Manual"
.SH NAME
xstrlen, vxstrlen, xstrcmp \- compute formatted string length and compare strings against an array
.SH SYNOPSIS
.nf
#include <xstring.h>

size_t vxstrlen(const char *restrict fmt, va_list ap);
size_t xstrlen(const char *restrict fmt, ...);
int xstrcmp(const char * __s1, const char ** __s2, size_t n);
.fi

.SH DESCRIPTION
The xstring library supplies helper routines that compute the number of
characters required to format a string, without writing any output and
without allocating memory.

These functions parallel the behavior of snprintf(3) and vsnprintf(3)
when called with a NULL buffer and a size of zero.

.SH vxstrlen()
vxstrlen() returns the number of characters that would be produced by
formatting the string described by \fIfmt\fP with the argument list
\fIap\fP.

On Windows systems, the function wraps \fB_vscprintf()\fP, which returns the
required buffer length.

On POSIX systems, the function uses:

.RS
vsnprintf(NULL, 0, fmt, ap)
.RE

The return value excludes the final NUL terminator.

If the formatted output would fail or cannot be determined, the function
returns 0.

.SH xstrlen()
xstrlen() is a convenience function wrapping vxstrlen(), accepting a
variadic argument list.

.SH xstrcmp()
xstrcmp() compares a single string (\fI__s1\fP) against an array of strings (\fI__s2\fP)
containing \fIn\fP elements. Returns 1 if a match is found, 0 otherwise.

Both \fI__s1\fP and array entries may be \fINULL\fP:

.IP "- Matching rules:"
.TP
* If both \fI__s1\fP and an array entry are NULL, it counts as a match.
* If only one is NULL, it is skipped.
* Otherwise, normal strcmp() comparison is used.

.SH RETURN VALUES
vxstrlen() and xstrlen() return the number of characters, excluding the
terminating NUL, or 0 if a formatting error occurred or \fIfmt\fP is NULL.

xstrcmp() returns 1 if \fI__s1\fP matches any element of \fI__s2\fP, 0 otherwise.

None of these functions set errno.

.SH ERRORS
Formatting errors result in a return value of 0. No additional error
information is provided.

.SH PORTABILITY
Windows uses the native \fB_vscprintf()\fP routine.
POSIX uses \fBvsnprintf(NULL,0,...)\fP.
The interface is portable across Windows, Linux, BSD, and macOS.

.SH EXAMPLES
.nf
size_t len = xstrlen("%s %d", "value", 10);
char *buf = malloc(len + 1);
sprintf(buf, "%s %d", "value", 10);

const char *arr[] = {"fff", "333", NULL};
int result;

result = xstrcmp("fff", arr, 3);   // returns 1
result = xstrcmp("abc", arr, 3);   // returns 0
result = xstrcmp(NULL, arr, 3);    // returns 0
result = xstrcmp(NULL, (const char*[]){NULL, "foo"}, 2); // returns 1
.fi

.SH SEE ALSO
snprintf(3), vsnprintf(3), strlen(3), strcmp(3)

.SH AUTHOR
Written by MrR736.

.SH COPYRIGHT
GPLv3 or later.
